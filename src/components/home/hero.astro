---
import { Logo, FuniqAILogo, FuniqTradingLogo, DrawYourselfLogo, XAgentsLogo } from '../SiteLogo';
import Projects from '../Projects.astro';
import { translateFor } from '@/i18n/utils';

const t = translateFor(Astro.currentLocale);

// Orbiting projects configuration
const orbitingProjects = [
  {
    id: 'xagents',
    logo: XAgentsLogo,
    ringClass: 'w-[180px] h-[180px] md:w-[240px] md:h-[240px]',
    ringAnimation: 'animate-[spin_30s_linear_infinite]',
    position: 'top-0 left-1/2 -translate-x-1/2 -translate-y-1/2',
    iconAnimation: 'animate-[spin_30s_linear_infinite_reverse]',
  },
  {
    id: 'funiq-ai',
    logo: FuniqAILogo,
    ringClass: 'w-[260px] h-[260px] md:w-[360px] md:h-[360px]',
    ringAnimation: 'animate-[spin_40s_linear_infinite_reverse]',
    position: 'top-1/2 right-0 translate-x-1/2 -translate-y-1/2',
    iconAnimation: 'animate-[spin_40s_linear_infinite]',
  },
  {
    id: 'draw-yourself',
    logo: DrawYourselfLogo,
    ringClass: 'w-[260px] h-[260px] md:w-[360px] md:h-[360px]',
    ringAnimation: 'animate-[spin_40s_linear_infinite_reverse]',
    position: 'bottom-0 left-1/2 -translate-x-1/2 translate-y-1/2',
    iconAnimation: 'animate-[spin_40s_linear_infinite]',
  },
  {
    id: 'funiq-trading',
    logo: FuniqTradingLogo,
    ringClass: 'w-[340px] h-[340px] md:w-[480px] md:h-[480px]',
    ringAnimation: 'animate-[spin_50s_linear_infinite]',
    position: 'top-1/2 left-0 -translate-x-1/2 -translate-y-1/2',
    iconAnimation: 'animate-[spin_50s_linear_infinite_reverse]',
  },
];

// Group by ring class for rendering
const ringGroups = orbitingProjects.reduce((acc, project) => {
  const key = `${project.ringClass}-${project.ringAnimation}`;
  if (!acc[key]) {
    acc[key] = {
      ringClass: project.ringClass,
      ringAnimation: project.ringAnimation,
      projects: [],
    };
  }
  acc[key].projects.push(project);
  return acc;
}, {} as Record<string, any>);
---

<section
  class="relative z-10 flex flex-col items-center justify-center flex-1 w-full py-12 px-4 overflow-hidden"
>
  <div
    class="w-full max-w-[90rem] grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center"
  >
    {/* Left: Typography & CTA */}
    <div
      class="text-center lg:text-left space-y-8 order-2 lg:order-1 relative"
    >
      {/* Decorative Blur behind text */}
      <div
        class="absolute -top-20 -left-20 w-64 h-64 bg-purple-400/20 rounded-full blur-[80px] pointer-events-none dark:bg-purple-900/20"
      >
      </div>

      <h1
        class="text-5xl sm:text-6xl md:text-7xl font-extrabold tracking-tight text-slate-900 dark:text-white leading-[1.1]"
      >
        {t('hero.title')} <br />
        <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400"
        >
          {t('hero.title.highlight')}
        </span>
      </h1>

      <p
        class="text-lg md:text-xl text-slate-500 dark:text-slate-400 max-w-2xl mx-auto lg:mx-0 leading-relaxed font-light"
      >
        {t('hero.description')}
        <span class="hidden sm:block">{t('hero.description.extra')}</span>
      </p>

      <Projects />
    </div>

    {/* Right: Visual Interactive Element */}
    <div
      class="relative order-1 lg:order-2 h-[400px] md:h-[500px] flex items-center justify-center perspective-1000"
    >
      {/* Main Glow */}
      <div
        id="hero-glow"
        class="absolute inset-0 bg-gradient-to-tr from-blue-500/20 to-purple-500/20 rounded-full blur-[100px] animate-pulse-slow"
      >
      </div>

      {/* Central Core */}
      <div
        id="magnetic-container"
        class="relative z-20 w-32 h-32 md:w-40 md:h-40 bg-white dark:bg-slate-900 rounded-full shadow-2xl flex items-center justify-center border border-slate-100 dark:border-slate-800"
      >
        <div
          class="absolute inset-0 rounded-full bg-gradient-to-b from-transparent to-slate-100/50 dark:to-slate-800/50 opacity-50"
        >
        </div>
        <div id="magnetic-logo" class="flex items-center justify-center w-full h-full transition-transform duration-100 ease-out will-change-transform">
          <Logo
            className="size-[80%] text-slate-900 dark:text-white"
          />
        </div>

        {/* Core Rings */}
        <div
          class="absolute -inset-4 border border-slate-200 dark:border-slate-700 rounded-full opacity-50"
        >
        </div>
        <div
          class="absolute -inset-8 border border-dashed border-slate-200 dark:border-slate-700 rounded-full opacity-30 animate-[spin_10s_linear_infinite]"
        >
        </div>
      </div>

      {/* Orbiting Elements Rings */}
      {Object.values(ringGroups).map((ring) => (
        <div
          class={`absolute z-10 border border-slate-200 dark:border-slate-800 rounded-full ${ring.ringClass} ${ring.ringAnimation}`}
        >
          {ring.projects.map((project: any) => (
            <div class={`absolute ${project.position}`}>
              <div
                class={`w-12 h-12 bg-white dark:bg-slate-800 rounded-full shadow-lg border border-slate-100 dark:border-slate-700 flex items-center justify-center ${project.iconAnimation}`}
              >
                <project.logo variant="icon" className="w-7 h-7" />
              </div>
            </div>
          ))}
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  const container = document.getElementById('magnetic-container');
  const logo = document.getElementById('magnetic-logo');
  const glow = document.getElementById('hero-glow');

  // Check if device is mobile (width < 1024px, matching Tailwind's lg breakpoint)
  const isMobile = () => window.innerWidth < 1024;

  const handleMouseMove = (e: MouseEvent) => {
    // Disable effects on mobile
    if (isMobile()) {
      if (logo) logo.style.transform = 'translate(0px, 0px)';
      return;
    }
    
    // Magnetic Logo Effect
    if (container && logo) {
      const rect = container.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      
      // Calculate vector from container center to mouse
      const deltaX = e.clientX - centerX;
      const deltaY = e.clientY - centerY;
      
      // Magnetic strength - how much the logo moves towards the mouse
      const strength = 0.1;
      let moveX = deltaX * strength;
      let moveY = deltaY * strength;
      
      // Logo is 80% of container size, so it has 10% margin on each side
      // Maximum safe movement is 10% of container width/height
      const maxMove = rect.width * 0.1;
      
      // Constrain movement to stay within white circle
      const distance = Math.sqrt(moveX * moveX + moveY * moveY);
      
      if (distance > maxMove) {
        const ratio = maxMove / distance;
        moveX *= ratio;
        moveY *= ratio;
      }
      
      logo.style.transform = `translate(${moveX}px, ${moveY}px)`;
    }

    // Glow Effect
    if (glow) {
      const x = e.clientX / window.innerWidth;
      const y = e.clientY / window.innerHeight;
      
      // More dramatic hue shift for better visibility
      // Range 1: Cyan (180) to Purple (280)
      // Range 2: Blue (220) to Pink (320)
      const hue1 = 180 + (x * 100); 
      const hue2 = 220 + (y * 100);
      
      // Dynamic angle
      const angle = 45 + (x * 45) + (y * 45);
      
      // Increased opacity (0.4) and saturation (90%) for visibility
      glow.style.background = `linear-gradient(${angle}deg, hsla(${hue1}, 90%, 60%, 0.2), hsla(${hue2}, 90%, 60%, 0.2))`;
    }
  };
  
  // Reset logo position on resize if switching to mobile
  const handleResize = () => {
    if (isMobile() && logo) {
      logo.style.transform = 'translate(0px, 0px)';
    }
  };
  
  // Listen to mouse movement on the entire document
  document.addEventListener('mousemove', handleMouseMove);
  window.addEventListener('resize', handleResize);
  
  // Clean up on page unload
  window.addEventListener('beforeunload', () => {
    document.removeEventListener('mousemove', handleMouseMove);
    window.removeEventListener('resize', handleResize);
  });
</script>

<style></style>
